#!/usr/bin/env bash

echo "
----------------------
  NVM
----------------------
"

sudo apt-get update
sudo apt-get install -y build-essential libssl-dev
sudo curl https://raw.githubusercontent.com/creationix/nvm/master/install.sh | sh
source ~/.profile
source ~/.bashrc


echo "
----------------------
  MONGODB
----------------------
"

# import mongodb 5.0 gpg key + repo

sudo apt-get install gnupg
wget -qO - https://www.mongodb.org/static/pgp/server-5.0.asc | sudo apt-key add -
echo "deb [ arch=amd64,arm64 ] https://repo.mongodb.org/apt/ubuntu focal/mongodb-org/5.0 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-5.0.list

sudo apt-get update

# install the latest version of mongodb
sudo apt-get install -y mongodb-org

# start mongodb
sudo systemctl start mongod
sudo systemctl enable mongod


echo "
----------------------
  NGINX
----------------------
"

# install nginx
sudo apt-get install -y nginx


echo "
----------------------
  UFW (FIREWALL)
----------------------
"

# allow ssh connections through firewall
sudo ufw allow OpenSSH

# allow http & https through firewall
sudo ufw allow 'Nginx Full'

# enable firewall
sudo ufw --force enable

project_dir=`pwd`
project_dir=${project_dir::-4}
echo "export WEBAPP_DIR=${project_dir}">~/.profile
source ~/.profile

